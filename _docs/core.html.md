# core


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

These are backend functions to help login, query, and store Plaid API
data

## API Calls

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L65"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_account_transactions

>  get_account_transactions (access_token:str, start_date:str, end_date:str)

*Retrieves all transactions for an account from the Plaid API.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>access_token</td>
<td>str</td>
<td>The Plaid access token for the user account</td>
</tr>
<tr>
<td>start_date</td>
<td>str</td>
<td>The starting date for transactions (YYYY-MM-DD)</td>
</tr>
<tr>
<td>end_date</td>
<td>str</td>
<td>The ending date for transactions (YYYY-MM-DD)</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>List</strong></td>
<td><strong>Returns List objects containing Dictionary objects related
to account transactions</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L50"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_account

>  get_account (access_token:str)

*Retrieves account details from the Plaid API.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>access_token</td>
<td>str</td>
<td>The Plaid access token for the user account</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Dict</strong></td>
<td><strong>Returns Dictionary object of accounts</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L37"
target="_blank" style="float:right; font-size:smaller">source</a>

### plaid_post

>  plaid_post (endpoint:str, payload:Dict[str,Any])

*Makes a POST request to the Plaid API.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>endpoint</td>
<td>str</td>
<td>The specific Plaid API endpoint (e.g., “accounts/get”), refer to <a
href="https://plaid.com/docs/api/">Plaid API Docs</a></td>
</tr>
<tr>
<td>payload</td>
<td>Dict</td>
<td>The JSON payload to be sent with the request</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Dict</strong></td>
<td><strong>Returns JSON response from Plaid API</strong></td>
</tr>
</tbody>
</table>

## Dataframe Transformation

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L125"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_transactions_df

>  get_transactions_df (access_tokens:List[Tuple[str]], start_date:str=None,
>                           end_date:str=None)

*Retrieves and converts transaction data for multiple access tokens into
a pandas DataFrame.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>access_tokens</td>
<td>List</td>
<td></td>
<td>List object containing access tokens</td>
</tr>
<tr>
<td>start_date</td>
<td>str</td>
<td>None</td>
<td>Optional start date (YYYY-MM-DD)</td>
</tr>
<tr>
<td>end_date</td>
<td>str</td>
<td>None</td>
<td>Optional end date (YYYY-MM-DD)</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>DataFrame</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L111"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_accounts_df

>  get_accounts_df (access_tokens:List[Tuple[str]])

*Retrieves and merges account information for multiple access tokens
into a single pandas DataFrame.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>access_tokens</td>
<td>List</td>
<td>List object containing access tokens</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>DataFrame</strong></td>
<td><strong>Returns Dataframe of accounts</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L103"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_account_df

>  get_account_df (accounts_response:dict)

*Converts account information from the Plaid API response into a pandas
DataFrame.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>accounts_response</td>
<td>dict</td>
<td>Dictionary object containing accounts</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>DataFrame</strong></td>
<td><strong>Returns Dataframe of individual account</strong></td>
</tr>
</tbody>
</table>

## Database Operations

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L417"
target="_blank" style="float:right; font-size:smaller">source</a>

### update_last_refresh

>  update_last_refresh (success=True, msg='Refresh was successful')

*Update database to log refresh time and status*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>True</td>
<td>Assumes that refresh was successful</td>
</tr>
<tr>
<td>msg</td>
<td>str</td>
<td>Refresh was successful</td>
<td>Refresh message</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L398"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_last_successful_refresh

>  get_last_successful_refresh ()

*Query database to check when the last successful refresh was*

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L355"
target="_blank" style="float:right; font-size:smaller">source</a>

### upsert_account_balances_df

>  upsert_account_balances_df (accounts_df:pandas.core.frame.DataFrame)

*Inserts or updates account balance history in the database.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>accounts_df</td>
<td>DataFrame</td>
<td>A DataFrame containing account balance data</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L273"
target="_blank" style="float:right; font-size:smaller">source</a>

### insert_transactions_df

>  insert_transactions_df (transactions_df:pandas.core.frame.DataFrame)

*Inserts transaction data into the database.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>transactions_df</td>
<td>DataFrame</td>
<td>A DataFrame containing transaction data</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L206"
target="_blank" style="float:right; font-size:smaller">source</a>

### insert_account_df

>  insert_account_df (access_token:str, accounts_response:dict, email:str,
>                         phone:str)

*Inserts account information and the associated access token into the
database.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>access_token</td>
<td>str</td>
<td>The Plaid access token for the account</td>
</tr>
<tr>
<td>accounts_response</td>
<td>dict</td>
<td>The response from the Plaid API containing account information</td>
</tr>
<tr>
<td>email</td>
<td>str</td>
<td>The user email</td>
</tr>
<tr>
<td>phone</td>
<td>str</td>
<td>The phone number associated with user</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L180"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_stored_public_access_tokens

>  get_stored_public_access_tokens ()

*Retrieves distinct Plaid access tokens from the local database.*

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L162"
target="_blank" style="float:right; font-size:smaller">source</a>

### db_sql

>  db_sql (query:str)

*Executes a defined SQL query and returns the result as a pandas
DataFrame.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>str</td>
<td>The string representation of SQL query to execute</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>DataFrame</strong></td>
<td><strong>Dataframe of executed SQL query</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L145"
target="_blank" style="float:right; font-size:smaller">source</a>

### db_conn

>  db_conn ()

*Creates and returns a connection to the PostgreSQL database.*

## Authentication

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L483"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_and_save_public_token

>  get_and_save_public_token (link_token:str, email:str, phone:str)

*Retrieves a public token using the link token, exchanges it for an
access token, and saves the account information to the database.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>link_token</td>
<td>str</td>
<td>The link token generated during the Plaid Link flow</td>
</tr>
<tr>
<td>email</td>
<td>str</td>
<td>The user’s email address</td>
</tr>
<tr>
<td>phone</td>
<td>str</td>
<td>The user’s phone number</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>None</strong></td>
<td></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L444"
target="_blank" style="float:right; font-size:smaller">source</a>

### generate_link_token

>  generate_link_token (email:str, phone:str)

*Generates a link token to authenticate with the Plaid API.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>email</td>
<td>str</td>
<td>The user’s email address</td>
</tr>
<tr>
<td>phone</td>
<td>str</td>
<td>The user’s phone number</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>Optional</strong></td>
<td><strong>Returns the generated link token if successful, otherwise
None</strong></td>
</tr>
</tbody>
</table>

## Tasks

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L579"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_and_save_balance_history

>  get_and_save_balance_history ()

\*Retrieves account balance history for stored public access tokens and
updates the balance history in the database.

Steps:

- Fetch public access tokens from the database.
- Retrieve account details for each account associated with the tokens.
- Update the account balance history in the database.

Returns: None\*

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L536"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_and_save_all_account_transactions

>  get_and_save_all_account_transactions (first_time=False)

\*Retrieves all account transactions for stored public access tokens and
inserts the transactions into the database.

Steps:

- Fetch public access tokens from the database.
- Retrieve transactions data for each account associated with the
  tokens. (2 cases, First time load or Incremental)
- Insert the retrieved transactions into the database.

Returns: None\*

------------------------------------------------------------------------

<a
href="https://github.com/billthan/jupyter-finance/blob/main/jupyter_finance/core.py#L608"
target="_blank" style="float:right; font-size:smaller">source</a>

### about

>  about ()

*Print environmental details for this instance of `jupyter-finance`*
